<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</title>
<meta name="description" content="Ø§Ù„Ù‚Ø±Ø¢Ù† â€” Ù‚Ø§Ø±Ø¦ Ù…ØªÙƒØ§Ù…Ù„ Ù„ØªÙ„Ø§ÙˆØ© ÙƒØªØ§Ø¨ Ø§Ù„Ù„Ù‡ Ø¹Ø² ÙˆØ¬Ù„ Ø¹Ø¨Ø± ÙˆØ§Ø¬Ù‡Ø© Ø­Ø¯ÙŠØ«Ø© ÙˆØ³Ù‡Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…. ØªØµÙØ­ Ø³ÙˆØ± Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŒ Ø§Ø³ØªÙ…Ø¹ Ù„ØªÙ„Ø§ÙˆØ§Øª Ø¨ØµÙˆØª Ø£Ø´Ù‡Ø± Ø§Ù„Ù‚Ø±Ø§Ø¡ØŒ ÙˆØ§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¢ÙŠØ§Øª Ø¨Ø³Ø±Ø¹Ø© ÙˆØ¯Ù‚Ø©. ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ÙˆØ§Ù„Ù†Ù‡Ø§Ø±ÙŠØŒ ÙˆØ§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ© Ø¨Ù„ØºØ§Øª Ù…ØªØ¹Ø¯Ø¯Ø©ØŒ Ù„ÙŠÙ…Ù†Ø­Ùƒ ØªØ¬Ø±Ø¨Ø© Ø±ÙˆØ­Ø§Ù†ÙŠØ© ÙˆØªÙ‚Ù†ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù…Ø¹ ÙƒÙ„Ø§Ù… Ø§Ù„Ù„Ù‡." />
<meta name="keywords" content="Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…, Ø§Ù„Ù‚Ø±Ø§Ù† Ø§Ù„ÙƒØ±ÙŠÙ…, ØªÙ„Ø§ÙˆØ© Ø§Ù„Ù‚Ø±Ø¢Ù†, Ø§Ø³ØªÙ…Ø§Ø¹ Ø§Ù„Ù‚Ø±Ø¢Ù†, Ù‚Ø±Ø§Ø¡ Ø§Ù„Ù‚Ø±Ø¢Ù†, ØªÙØ³ÙŠØ± Ø§Ù„Ù‚Ø±Ø¢Ù†, Ø³ÙˆØ± Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…, Ø¢ÙŠØ§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†, Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙ, Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§ÙˆÙ†Ù„Ø§ÙŠÙ†, Ù‚Ø±Ø¢Ù† ÙƒØ±ÙŠÙ… Ø¨ØµÙˆØª Ø¬Ù…ÙŠÙ„, Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… ÙƒØ§Ù…Ù„, ØªØ¬ÙˆÙŠØ¯ Ø§Ù„Ù‚Ø±Ø¢Ù†, Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù†, Ù…Ø¹Ø§Ù†ÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù†, ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†, Ù…ØµØ­Ù Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠ, ØªÙØ³ÙŠØ± Ø§Ø¨Ù† ÙƒØ«ÙŠØ±, Ø§Ù„Ù‚Ø§Ø±Ø¦ Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ø³Ø·, Ø§Ù„Ù‚Ø§Ø±Ø¦ Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙØ§Ø³ÙŠ, Ø§Ù„Ù‚Ø§Ø±Ø¦ Ø§Ù„Ø­ØµØ±ÙŠ, Ø§Ù„Ù‚Ø§Ø±Ø¦ Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ, Ø§Ù„Ù‚Ø§Ø±Ø¦ Ø§Ù„Ø³Ø¯ÙŠØ³, Ø§Ù„Ù‚Ø§Ø±Ø¦ Ù…Ø§Ù‡Ø± Ø§Ù„Ù…Ø¹ÙŠÙ‚Ù„ÙŠ, Ø§Ø³ØªÙ…Ø§Ø¹ Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù‚Ø±Ø¢Ù†, ØªØ·Ø¨ÙŠÙ‚ Ù‚Ø±Ø¢Ù†, Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù‚Ø±Ø¢Ù†, ØªØ¹Ù„ÙŠÙ… Ø§Ù„ØªØ¬ÙˆÙŠØ¯, Ø£Ø­ÙƒØ§Ù… Ø§Ù„ØªÙ„Ø§ÙˆØ©, Ù…Ø­Ø±Ùƒ Ø¨Ø­Ø« Ø§Ù„Ù‚Ø±Ø¢Ù†, Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù†, Ø¢ÙŠØ§Øª Ù…Ù† Ø§Ù„Ù‚Ø±Ø¢Ù†, Ø§Ù„Ø³ÙˆØ± Ø§Ù„Ù…ÙƒÙŠØ© ÙˆØ§Ù„Ù…Ø¯Ù†ÙŠØ©, Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ù…ÙØ³Ø±, Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ù…Ø³Ù…ÙˆØ¹, Ø£ÙØ¶Ù„ Ù…ÙˆÙ‚Ø¹ Ù‚Ø±Ø¢Ù†, Ù‚Ø±Ø¢Ù† Ù„Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±, Ù‚Ø±Ø¢Ù† Ù„Ù„Ø¬ÙˆØ§Ù„, Ù‚Ø±Ø¢Ù† Ø¨Ø¯ÙˆÙ† Ø§Ù†ØªØ±Ù†Øª, ØªÙ„Ø§ÙˆØ© Ø®Ø§Ø´Ø¹Ø©, Ø®ØªÙ…Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†, ØªÙØ³ÙŠØ± Ø¢ÙŠØ§Øª, ØªØ¯Ø¨Ø± Ø§Ù„Ù‚Ø±Ø¢Ù†, Ù…Ø¹Ø§Ù†ÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª, Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©, Ø§Ù„Ø¥Ø³Ù„Ø§Ù…, Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­ ÙˆØ§Ù„Ù…Ø³Ø§Ø¡, Ø£Ø°ÙƒØ§Ø±, Ø¯Ø¹Ø§Ø¡, Ø£Ø¯Ø¹ÙŠØ© Ù‚Ø±Ø¢Ù†ÙŠØ©, ØªÙ„Ø§ÙˆØ© Ù…Ø±ØªÙ„Ø©, Ø§Ø³ØªÙ…Ø§Ø¹ Ø³ÙˆØ± Ù‚ØµÙŠØ±Ø©, Ø§Ø³ØªÙ…Ø§Ø¹ Ø³ÙˆØ± Ø·ÙˆÙŠÙ„Ø©, Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ù…Ø±ØªÙ„, Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ù…Ø¬ÙˆØ¯, Ù‚Ø±Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠ, Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ, Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ, Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ, Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„Ø­Ø¯ÙŠØ«, Ù…ÙˆÙ‚Ø¹ ØªÙ„Ø§ÙˆØ© Ù…Ù…ÙŠØ², Ù…ØµØ­Ù Ø¨ØªØµÙ…ÙŠÙ… Ø¬Ù…ÙŠÙ„, Ù…ÙˆÙ‚Ø¹ Ø±ÙˆØ­Ø§Ù†ÙŠ, Ù…Ù†ØµØ© Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø±Ù‚Ù…ÙŠØ©" />
<link rel="sitemap" type="application/xml" title="Sitemap" href="sitemap.xml" />  
<link rel="icon" href="favicon.ico">
<link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:#0b0f12;
    --panel:#0f1516;
    --muted:#8b99a6;
    --accent:#00b3a6;
    --card:#12171a;
    --glass: rgba(255,255,255,0.02);
    --radius:12px;
    --shadow: 0 6px 24px rgba(2,6,8,0.6);
  }

  /* ğŸŒ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ */
  html.light {
    --bg:#f6fbfb;
    --panel:#ffffff;
    --muted:#6b7280;
    --accent:#007b7b;
    --card:#ffffff;
    --glass: rgba(0,0,0,0.03);
    color:#111;
  }

  html.light body {
    background: var(--bg);
    color: #111;
  }

  html.light header {
    background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.8));
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }

  html.light .icon-btn:hover {
    background: rgba(0,0,0,0.05);
    color: #000;
  }

  html.light .chapter-item {
    background: rgba(0,0,0,0.02);
    border-color: rgba(0,0,0,0.08);
  }

  html.light .verse {
    background: rgba(0,0,0,0.02);
    border-color: rgba(0,0,0,0.05);
  }

  html.light input,
  html.light select {
    background: #fff;
    color: #000;
    border-color: rgba(0,0,0,0.1);
  }

  html.light .btn {
    color: #fff;
    background: var(--accent);
  }

  /* ğŸ”¼ Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø£Ø¹Ù„Ù‰ */
  #scrollTopBtn {
    position: fixed;
    bottom: 24px;
    right: 24px;
    width: 52px;
    height: 52px;
    border-radius: 50%;
    border: none;
    background: var(--accent, #009688);
    color: #fff;
    font-size: 22px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: all 0.4s ease;
    backdrop-filter: blur(4px);
    z-index: 999;
  }

  #scrollTopBtn.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  #scrollTopBtn:hover {
    background: var(--accent-strong, #00bfa5);
    box-shadow: 0 6px 18px rgba(0, 255, 200, 0.4);
    transform: scale(1.1);
  }

  html:not(.light) #scrollTopBtn {
    background: #1a1a1a;
    color: #00e0b0;
    box-shadow: 0 4px 10px rgba(0,0,0,0.6);
  }

  html:not(.light) #scrollTopBtn:hover {
    background: #00bfa5;
    color: #fff;
  }

  html,body {
    height:100%;
    margin:0;
    font-family:'Cairo','Amiri',serif;
    background:var(--bg);
    color:#e6eef3;
    direction:rtl;
  }

  a { color:inherit }

  header {
    position:fixed;
    top:0;
    left:0;
    right:0;
    height:64px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    backdrop-filter:blur(6px);
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:10px 18px;
    z-index:1200;
    box-shadow:0 2px 6px rgba(0,0,0,0.6);
  }

  .brand {display:flex;align-items:center;gap:12px}
  .brand .logo-box {
    width:44px;height:44px;border-radius:10px;
    background:linear-gradient(135deg,var(--accent),#00e6d6);
    display:flex;align-items:center;justify-content:center;
    font-weight:700;color:#021;font-size:18px
  }
  .brand h1{margin:0;font-size:18px;font-weight:700}

  .header-actions{display:flex;align-items:center;gap:8px}
  .search-top{min-width:320px}
  input.search-top{
    width:100%;padding:10px 12px;border-radius:10px;
    border:1px solid rgba(255,255,255,0.03);
    background:var(--panel);color:inherit;outline:none
  }

  .icon-btn{
    background:transparent;border:0;color:var(--muted);
    cursor:pointer;padding:8px;border-radius:8px
  }
  .icon-btn:hover{color:white;background:var(--glass)}

  .container{display:flex;gap:18px;max-width:1200px;margin:84px auto 48px;padding:0 18px}

  .sidebar{
    width:320px;
    background:linear-gradient(180deg,var(--card),#0e1415);
    padding:18px;border-radius:14px;
    border:1px solid rgba(255,255,255,0.02);
    height:calc(100vh - 120px);
    position:sticky;top:72px;overflow:auto;box-shadow:var(--shadow);
  }

  .sidebar .logo-compact{display:flex;align-items:center;gap:12px;margin-bottom:12px}
  .sidebar h2{margin:0;font-size:18px}
  .controls{display:flex;gap:8px;align-items:center;margin:12px 0}
  .controls select,.controls button{background:transparent;border:1px solid rgba(255,255,255,0.03);color:inherit;padding:8px;border-radius:10px;cursor:pointer}

  .chapters{margin-top:10px;display:flex;flex-direction:column;gap:8px}
  .chapter-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);cursor:pointer;border:1px solid rgba(255,255,255,0.02)}
  .chapter-item:hover{transform:translateY(-2px)}
  .muted{color:var(--muted);font-size:13px}
  .fav-box{margin-top:14px;padding:10px;border-radius:10px;background:linear-gradient(90deg,rgba(255,255,255,0.01),rgba(255,255,255,0.005));border:1px solid rgba(255,255,255,0.02)}

  .main{flex:1;min-height:60vh}
  .surah-card{background:linear-gradient(180deg,var(--card),#0e1415);padding:18px;border-radius:14px;border:1px solid rgba(255,255,255,0.02);box-shadow:var(--shadow)}
  .surah-head{display:flex;justify-content:space-between;align-items:center;gap:12px}
  .surah-title{font-size:20px;font-weight:700}
  .controls-row{display:flex;gap:8px;align-items:center;margin-top:12px;flex-wrap:wrap}
  .btn{background:var(--accent);color:#021;padding:8px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
  .btn.alt{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
  .player-wrap{margin-top:12px}
  .verses{margin-top:18px;display:flex;flex-direction:column;gap:10px}
  .verse{background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.02);cursor:pointer}
  .verse .arab{font-family:'Amiri',serif;font-size:26px;line-height:2;text-align:right}
  .verse .meta{display:flex;justify-content:space-between;align-items:center;margin-top:8px;color:var(--muted);font-size:13px}
  .verse.active{outline:3px solid rgba(0,179,166,0.12);box-shadow:0 8px 28px rgba(0,179,166,0.06)}

  .mobile-menu-btn{display:none}
  .mobile-search{display:none}

  header {
    position: sticky;
    top: 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 20px;
    z-index: 1000;
    border-bottom: 1px solid #ddd;
  }

  header .brand {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  header .logo-box {
    background: var(--accent, #2c7);
    color: #fff;
    font-weight: bold;
    border-radius: 50%;
    width: 35px;
    height: 35px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .center-search {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
  }

  .center-search input {
    width: 420px;
    max-width: 90vw;
    padding: 8px 14px;
    border-radius: 20px;
    border: 1px solid #ccc;
    font-size: 15px;
    outline: none;
    background: var(--bg);
    color: var(--text);
  }

  .header-actions {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  @media (max-width:900px){
    header {
      display:flex;
      gap:3px;
      padding:10px 14px;
      position:sticky;
      top:0;
      z-index:100;
      box-shadow:0 1px 4px rgba(255,255,255,0.05);
    }
    .header-row{display:flex;align-items:center;justify-content:space-between;gap:6px;flex-wrap:nowrap}
    .site-title{color:#fff;font-size:18px;font-weight:600;margin:0;white-space:nowrap}
    .logo-box{background:var(--accent,#00e0b0);color:#000;font-weight:bold;width:34px;height:34px;display:flex;align-items:center;justify-content:center;border-radius:10px;font-size:18px}
    .header-actions{display:flex;align-items:center;gap:6px}
    .icon-btn,select,.mobile-menu-btn{background:var(--card,#161b22);border:none;color:#fff;border-radius:8px;padding:6px 10px;font-size:14px;cursor:pointer}
    .mobile-search{display:flex;align-items:center;background:var(--card,#161b22);border-radius:10px;padding:6px 12px;width:100%}
    .mobile-search input{width:100%;background:transparent;border:none;outline:none;color:#fff;font-size:15px}
    .mobile-search input::placeholder{color:rgba(255,255,255,0.6)}
    header .search-top{display:none}
    .container{flex-direction:column;padding:12px;margin-top:72px}
    .sidebar{position:fixed;right:12px;top:76px;width:320px;height:calc(100vh - 96px);transform:translateX(110%);transition:transform .28s ease;z-index:1300}
    .sidebar.open{transform:translateX(0)}
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:1200;opacity:0;pointer-events:none;transition:opacity .28s}
    .overlay.show{opacity:1;pointer-events:auto}
    .mobile-menu-btn{display:block;background:var(--panel);border:1px solid rgba(255,255,255,0.03);color:var(--muted);padding:8px 10px;border-radius:10px}
  }

  select,input{background:transparent;color:inherit;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:10px}
  small.muted{color:var(--muted);font-size:12px}
  footer{margin-top:30px;color:var(--muted);text-align:center;font-size:13px}
</style>
</head>
<body>
<!-- Header (sticky top) -->
<header>
  <button id="mobileMenuBtn" class="mobile-menu-btn">â˜°</button>

  <!-- Ø§Ù„Ø´Ø¹Ø§Ø± -->
  <div class="brand">
    <div class="logo-box">Ù‚</div>
    <div>
      <h1 id="siteTitle">Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</h1>
    </div>
  </div>

  <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ -->
  <div class="center-search">
    <input id="topSearch" class="search-top" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¢ÙŠØ§ØªØŒ Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø©ØŒ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ©" />
  </div>

  <!-- Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
  <div class="header-actions">
    <div class="mobile-search">
      <input id="mobileSearch" data-i18n-placeholder="search_placeholder" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø³ÙˆØ± Ø£Ùˆ Ø§Ù„Ø¢ÙŠØ§Øª..." />
    </div>

    <button id="toggleTheme" class="icon-btn" title="ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ/Ù†Ù‡Ø§Ø±ÙŠ">ğŸŒ“</button>
  </div>
</header>

<div class="container">
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="controls">
      <div style="flex:1"><input id="sideSearch" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø³ÙˆØ±..." /></div>
      <select id="reciterSelect" title="Ø§Ø®ØªØ§Ø± Ø§Ù„Ù‚Ø§Ø±Ø¦"></select>
    </div>

    <div style="margin-top:8px"><strong id="chaptersLabel">Ø§Ù„Ø³ÙˆØ±</strong></div>
    <div id="chaptersList" class="chapters" role="list"></div>

  </aside>

  <!-- Main -->
  <main class="main">
    <div class="surah-card">
      <div class="surah-head">
        <div>
          <div id="surahTitle" class="surah-title">Ø§Ø®ØªØ± Ø³ÙˆØ±Ø©</div>
          <div id="surahMeta" class="muted">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±</div>
        </div>

        <div>
          <div class="controls-row">
            <select id="translationSelect" title="Ø§Ù„ØªØ±Ø¬Ù…Ø©">
              <option value="">Ø¨Ø¯ÙˆÙ† ØªØ±Ø¬Ù…Ø©</option>
            </select>
            <select id="tafsirSelect" title="Ø§Ù„ØªÙØ³ÙŠØ±">
              <option value="">Ø¨Ø¯ÙˆÙ† ØªÙØ³ÙŠØ±</option>
            </select>
            <button id="playSurahBtn" class="btn">â–¶ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø©</button>
            <button id="scrollToLast" class="btn alt">ğŸ” Ø¢Ø®Ø± Ù‚Ø±Ø§Ø¡Ø©</button>
          </div>
          <div class="player-wrap" id="playerWrap"></div>
        </div>
      </div>

      <div id="versesWrap" class="verses"></div>
    </div>

    <footer id="footer">Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… â€¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</footer>
  </main>
</div>

<!-- overlay for mobile -->
<div id="overlay" class="overlay"></div>

<script>
/* ============================
   JavaScript â€” ÙƒØ§Ù…Ù„
   - ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ± ÙˆØ§Ù„Ø¢ÙŠØ§Øª Ù…Ù† alquran.cloud
   - Ø¨Ø­Ø« Ø°ÙƒÙŠ (ignores tashkeel & hamza)
   - Ù‚Ø§Ø¦Ù…Ø© Ù‚Ø±Ù‘Ø§Ø¡ Ù…Ø¹ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø±ÙˆØ§Ø¨Ø· Ù…ØªØ¹Ø¯Ø¯Ø© Ù„ÙƒÙ„ Ù‚Ø§Ø±Ø¦
   - ØªØ´ØºÙŠÙ„ ØµÙˆØª Ù…Ø¹ ØªØ¬Ø±Ø¨Ø© Ø¨Ø¯Ø§Ø¦Ù„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø·Ø£
   - Ø­ÙØ¸ Ù…ÙØ¶Ù„Ø§Øª Ùˆ Ø¢Ø®Ø± Ù‚Ø±Ø§Ø¡Ø© Ùˆ ÙˆØ¶Ø¹ Ø¯Ø§ÙƒÙ†
   - ÙˆØ§Ø¬Ù‡Ø© Ù…ØªØ¬Ø§ÙˆØ¨Ø© Ùˆ sidebar mobile toggle
   ============================ */

/* ---------- Config: reciters patterns (multiple patterns per reciter) ---------- */
const RECITERS = {
  "Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙØ§Ø³ÙŠ": [
    "https://server11.mp3quran.net/afs/{c}.mp3",
    "https://server8.mp3quran.net/afs/{c}.mp3"
  ],
    "Ù…Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯ Ø§Ù„Ø·Ø¨Ù„Ø§ÙˆÙŠ": [
    "https://server12.mp3quran.net/tblawi/{c}.mp3"
  ],
  "Ù…Ø­Ù…Ø¯ ØµØ¯ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ": [
    "https://server10.mp3quran.net/minsh/{c}.mp3",
    "https://server9.mp3quran.net/minsh/{c}.mp3",
    "https://server8.mp3quran.net/minsh//{c}.mp3"
  ],
  "Ù…Ø­Ù…ÙˆØ¯ Ø®Ù„ÙŠÙ„ Ø§Ù„Ø­ØµØ±ÙŠ": [
    "https://server13.mp3quran.net/husr/{c}.mp3",
    "https://server12.mp3quran.net/husary/{c}.mp3"
  ],
  "Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ø³Ø· Ø¹Ø¨Ø¯ Ø§Ù„ØµÙ…Ø¯": [
    "https://server7.mp3quran.net/basit/{c}.mp3",
    "https://server12.mp3quran.net/basit/{c}.mp3"
  ],
  "Ø³Ø¹Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ": [
    "https://server7.mp3quran.net/s_gmd/{c}.mp3",
    "https://server11.mp3quran.net/s_gmd/{c}.mp3"
  ],
  "Ù…Ø§Ù‡Ø± Ø§Ù„Ù…Ø¹ÙŠÙ‚Ù„ÙŠ": [
    "https://server12.mp3quran.net/maher/{c}.mp3",
    "https://server11.mp3quran.net/maher/{c}.mp3"
  ],
  "ÙŠØ§Ø³Ø± Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ": [
    "https://server11.mp3quran.net/yasser/{c}.mp3",
    "https://server8.mp3quran.net/yasser/{c}.mp3"
  ],
  "Ø¥Ø¯Ø±ÙŠØ³ Ø£Ø¨ÙƒØ±": [
    "https://server6.mp3quran.net/abkr/{c}.mp3"
  ]
};

/* ---------- DOM references ---------- */
const sidebar = document.getElementById('sidebar');
const chaptersList = document.getElementById('chaptersList');
const versesWrap = document.getElementById('versesWrap');
const surahTitle = document.getElementById('surahTitle');
const surahMeta = document.getElementById('surahMeta');
const reciterSelect = document.getElementById('reciterSelect');
const translationSelect = document.getElementById('translationSelect');
const tafsirSelect = document.getElementById('tafsirSelect');
const playerWrap = document.getElementById('playerWrap');
const favoritesBox = document.getElementById('favoritesBox');
const playSurahBtn = document.getElementById('playSurahBtn');
const overlayEl = document.getElementById('overlay');
const mobileMenuBtn = document.getElementById('mobileMenuBtn');
const mobileMenuButton = document.getElementById('mobileMenuBtn');
const topSearch = document.getElementById('topSearch');
const sideSearch = document.getElementById('sideSearch');
const toggleThemeBtn = document.getElementById('toggleTheme');
const gotoFavBtn = document.getElementById('gotoFav');
const scrollToLastBtn = document.getElementById('scrollToLast');

/* ---------- State ---------- */
let quran = []; // full quran surahs
let currentSurah = null;
let audioEl = null;
let lastAudioTryIndex = 0;
let audioUrlsTried = [];
let favorites = JSON.parse(localStorage.getItem('q_favs_v3') || '[]');

/* ---------- Utils: normalize Arabic (remove tashkeel, hamza, alifs variants) ---------- */
function normalizeArabic(text=''){
  return String(text||'')
    .normalize('NFKC')
    .replace(/[\u064B-\u065F\u0610-\u061A\u06D6-\u06DC\u06DF-\u06E8\u06EA-\u06ED]/g,'') // tashkeel
    .replace(/[Ø¥Ø£Ø¢Ø§Ù±]/g,'Ø§')
    .replace(/Ø¤/g,'Ùˆ').replace(/Ø¦/g,'ÙŠ')
    .replace(/Ù‰/g,'ÙŠ').replace(/Ø©/g,'Ù‡')
    .replace(/[^\u0600-\u06FF0-9\s]/g,'')
    .trim().toLowerCase();
}

/* ---------- Sidebar mobile toggle ---------- */
mobileMenuBtn.addEventListener('click', ()=> {
  sidebar.classList.add('open');
  overlayEl.classList.add('show');
});
overlayEl.addEventListener('click', ()=> {
  sidebar.classList.remove('open');
  overlayEl.classList.remove('show');
});
  
/* ---------- Theme handling ---------- */
(function initTheme() {
  const toggleThemeBtn = document.getElementById('toggleTheme');
  const root = document.documentElement;
  const stored = localStorage.getItem('q_theme_v3');

  // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: Ù„ÙŠÙ„ÙŠ
  if (stored === 'light') {
    root.classList.add('light');
  } else {
    root.classList.remove('light');
  }

  // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ·
  toggleThemeBtn.addEventListener('click', () => {
    if (root.classList.contains('light')) {
      root.classList.remove('light');
      localStorage.setItem('q_theme_v3', 'dark');
    } else {
      root.classList.add('light');
      localStorage.setItem('q_theme_v3', 'light');
    }
  });
})();

/* ---------- Populate reciters dropdown ---------- */
function populateReciters(){
  reciterSelect.innerHTML = '';
  Object.keys(RECITERS).forEach(name=>{
    const opt = document.createElement('option'); opt.value = name; opt.textContent = name;
    reciterSelect.appendChild(opt);
  });
}

/* ---------- Load translations & tafsirs selects (static list) ---------- */
function populateTranslationsAndTafsirs(){
  const translations = [
    {code:'en.sahih',name:'English â€” Sahih International'},
    {code:'en.yusufali',name:'English â€” Yusuf Ali'},
    {code:'fr.sherif',name:'FranÃ§ais â€” Sherif'},
    {code:'ur.jalandhry',name:'Ø§Ø±Ø¯Ùˆ â€” Ø¬Ø§Ù„Ù†Ø¯Ú¾Ø±ÛŒ'},
    {code:'id.indonesian',name:'Bahasa Indonesia'}
  ];
  translationSelect.innerHTML = '<option value="">Ø¨Ø¯ÙˆÙ† ØªØ±Ø¬Ù…Ø©</option>';
  translations.forEach(t=> translationSelect.appendChild(Object.assign(document.createElement('option'),{value:t.code,textContent:t.name})));

  const tafsirs = [
    {code:'ar.jalalayn',name:'ØªÙØ³ÙŠØ± Ø§Ù„Ø¬Ù„Ø§Ù„ÙŠÙ†'},
    {code:'ar.saadi',name:'ØªÙØ³ÙŠØ± Ø§Ù„Ø³Ø¹Ø¯ÙŠ'},
    {code:'en.maududi',name:'Tafsir â€” Maududi (EN)'}
  ];
  tafsirSelect.innerHTML = '<option value="">Ø¨Ø¯ÙˆÙ† ØªÙØ³ÙŠØ±</option>';
  tafsirs.forEach(t=> tafsirSelect.appendChild(Object.assign(document.createElement('option'),{value:t.code,textContent:t.name})));
}

/* ---------- Load full Quran (uthmani) ---------- */
async function loadQuran(){
  try{
    const res = await fetch('source/surah.json');
    quran = await res.json();

    renderChapters();

    const last = JSON.parse(localStorage.getItem('q_last_v3') || 'null');
    if (last && last.surah) {
      openSurah(last.surah);
    }
  }catch(e){
    console.error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ surah.json', e);
    alert('ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù† Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©');
  }
}
/* ---------- Render chapters list ---------- */
function renderChapters(filter=''){
  chaptersList.innerHTML = '';
  const q = normalizeArabic(filter||'');
  quran.forEach(s=>{
    if (q && !normalizeArabic(s.name).includes(q) && !(s.englishName && s.englishName.toLowerCase().includes(q)) && String(s.number)!==q) return;
    const d = document.createElement('div'); d.className='chapter-item';
    d.innerHTML = `<div>
      <div style="font-weight:600">${s.number}. ${s.name}</div>
      <div class="chapter-meta">${s.englishName||''} â€¢ ${s.ayahs?.length||0} Ø¢ÙŠØ©</div>
    </div><div style="color:var(--accent)">â–¶</div>`;
    d.onclick = ()=> { openSurah(s.number); if(window.innerWidth<900){ sidebar.classList.remove('open'); overlayEl.classList.remove('show'); } };
    chaptersList.appendChild(d);
  });
}

/* ---------- Open surah and render verses ---------- */
async function openSurah(number){
  try{
    const res = await fetch(`source/surah/surah_${number}.json`);
    const s = await res.json();

    currentSurah = s;
    surahTitle.textContent = `${s.number} â€” ${s.name}`;
    surahMeta.textContent = `${s.englishName || ''} â€¢ ${s.ayahs.length} Ø¢ÙŠØ©`;

    renderVerses(s);
    populateReciterPlayer(s);

    localStorage.setItem(
      'q_last_v3',
      JSON.stringify({ surah: s.number, at: Date.now() })
    );
  }catch(e){
    console.error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø©', e);
    alert('ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø© Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©');
  }
}
/* ---------- Render verses list ---------- */
function renderVerses(surah){
  versesWrap.innerHTML = '';
  (surah.ayahs || []).forEach(a=>{
    const el = document.createElement('div'); el.className='verse';
    el.dataset.verse = a.numberInSurah;
    el.innerHTML = `<div class="arab">${a.text}</div>
      <div class="meta"><small class="muted">ï´¿${a.numberInSurah}ï´¾ â€” ${surah.name}</small>
      </div>
      <div class="trans" style="display:none;margin-top:8px;color:var(--muted)"></div>
      <div class="tafsir" style="display:none;margin-top:8px;color:var(--muted)"></div>`;
    el.addEventListener('click', (ev)=>{
      if(ev.target && ev.target.classList.contains('save-btn')) { toggleFavorite(a); ev.stopPropagation(); return; }
      toggleVerseDetails(a, el);
    });
    versesWrap.appendChild(el);
  });
}

/* ---------- Toggle load translation & tafsir for a verse ---------- */
async function toggleVerseDetails(ayah, verseEl){
  const transEl = verseEl.querySelector('.trans');
  const tafsirEl = verseEl.querySelector('.tafsir');
  if(transEl.style.display==='block' || tafsirEl.style.display==='block'){ transEl.style.display='none'; tafsirEl.style.display='none'; return; }

  const transCode = translationSelect.value;
  const tafsirCode = tafsirSelect.value;

  if(transCode){
    transEl.style.display='block'; transEl.textContent='...Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø©';
    try{
      const res = await fetch(`https://api.alquran.cloud/v1/ayah/${ayah.number}/${transCode}`);
      const j = await res.json();
      transEl.innerHTML = j?.data?.text || 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ±Ø¬Ù…Ø©.';
    }catch(e){ transEl.textContent='ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„ØªØ±Ø¬Ù…Ø©'; console.warn(e); }
  }
  if(tafsirCode){
    tafsirEl.style.display='block'; tafsirEl.textContent='...Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙØ³ÙŠØ±';
    try{
      const res = await fetch(`https://api.alquran.cloud/v1/ayah/${ayah.number}/${tafsirCode}`);
      const j = await res.json();
      tafsirEl.innerHTML = j?.data?.text ? `<strong>Ø§Ù„ØªÙØ³ÙŠØ±:</strong><br>${j.data.text}` : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙØ³ÙŠØ±.';
    }catch(e){ tafsirEl.textContent='ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„ØªÙØ³ÙŠØ±'; console.warn(e); }
  }
  // mark last read to this ayah
  localStorage.setItem('q_last_v3', JSON.stringify({surah: currentSurah.number, verse: ayah.numberInSurah, at: Date.now()}));
}

/* ---------- Populate reciter player & handle URL fallbacks ---------- */
function populateReciterPlayer(surah){
  playerWrap.innerHTML = '';
  const reciterName = reciterSelect.value || Object.keys(RECITERS)[0];
  const selectHtml = `<label class="muted">Ø§Ù„Ù‚Ø§Ø±Ø¦:</label>
    <select id="playerReciterSelect">${Object.keys(RECITERS).map(r=>`<option ${r===reciterName?'selected':''} value="${r}">${r}</option>`).join('')}</select>`;
  const audioHtml = `<div style="margin-top:8px"><audio id="surahAudio" controls preload="none" style="width:100%"></audio></div>`;
  playerWrap.innerHTML = selectHtml + audioHtml;

  // set event
  document.getElementById('playerReciterSelect').addEventListener('change', ()=> initAudioForSurah(surah));
  initAudioForSurah(surah);
}

/* try multiple url patterns until one works (handles audio error event) */
function initAudioForSurah(surah){
  const reciter = document.getElementById('playerReciterSelect').value;
  const patterns = RECITERS[reciter] || [];
  const audio = document.getElementById('surahAudio');
  if(!audio) return;
  audio.pause();
  audio.removeAttribute('src'); audio.innerHTML='';

  // build list of possible urls
  const c = String(surah.number).padStart(3,'0');
  audioUrlsTried = patterns.map(p => p.replace('{c}', c));
  lastAudioTryIndex = 0;
  tryNextAudio();
  // attach error handler to try next
  audio.onerror = ()=> {
    console.warn('audio error, trying next url...');
    lastAudioTryIndex++;
    if(lastAudioTryIndex < audioUrlsTried.length) tryNextAudio();
    else {
      // all failed: show message
      playerWrap.querySelector('#surahAudio').outerHTML = `<div class="muted">ØªØ¹Ø°Ø± ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¹Ø¨Ø± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ØªØ§Ø­Ø©. ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¬Ø±Ø¨Ø© Ù‚Ø§Ø±Ø¦ Ø¢Ø®Ø± Ø£Ùˆ Ø±ÙØ¹ Ø§Ù„ØªÙ„Ø§ÙˆØ© Ø¹Ù„Ù‰ Ø§Ø³ØªØ¶Ø§ÙØ© Ø®Ø§ØµØ©.</div>`;
    }
  };
  audio.onplaying = ()=> {
    // success
    console.log('playing audio');
  };
}
function tryNextAudio(){
  const audio = document.getElementById('surahAudio');
  if(!audio) return;
  const url = audioUrlsTried[lastAudioTryIndex];
  audio.src = url;
  audio.load();
  // try to play (may be blocked by browser autoplay policy if not user triggered)
  audio.play().catch(()=> { /* ignore autoplay block */ });
}

/* ---------- Play whole surah button ---------- */
playSurahBtn.addEventListener('click', ()=> {
  if(!currentSurah){ alert('Ø§Ø®ØªØ± Ø³ÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹'); return; }
  initAudioForSurah(currentSurah);
});

/* ---------- Search (top and side) ---------- */
topSearch.addEventListener('input', (e)=> {
  const q = e.target.value.trim();
  if(!q) return;
  performGlobalSearch(q);
});
sideSearch && sideSearch.addEventListener('input', (e)=> renderChapters(e.target.value));

function performGlobalSearch(query){
  const q = normalizeArabic(query);
  if(!q) { renderChapters(); return; }
  // search surah names & ayahs
  const results = [];
  quran.forEach(s=>{
    if(normalizeArabic(s.name).includes(q) || String(s.number)===q) results.push({type:'surah', surah:s});
    s.ayahs && s.ayahs.forEach(a=>{
      if(normalizeArabic(a.text).includes(q) || String(a.numberInSurah)===q) results.push({type:'ayah', surah:s, ayah:a});
    });
  });
  // show results
  versesWrap.innerHTML = `<h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† "${query}" â€” ${results.length} Ù†ØªÙŠØ¬Ø©</h3>`;
  results.slice(0,300).forEach(r=>{
    if(r.type==='surah'){
      const el = document.createElement('div'); el.className='chapter-item';
      el.innerHTML = `<div><div style="font-weight:600">${r.surah.number}. ${r.surah.name}</div><div class="muted">${r.surah.englishName||''}</div></div>`;
      el.onclick = ()=> openSurah(r.surah.number);
      versesWrap.appendChild(el);
    } else {
      const el = document.createElement('div'); el.className='verse';
      el.innerHTML = `<div class="arab">${r.ayah.text}</div><div class="meta"><small class="muted">${r.surah.name} â€” ï´¿${r.ayah.numberInSurah}ï´¾</small></div>`;
      el.onclick = ()=> { openSurah(r.surah.number); setTimeout(()=> {
        const t = [...document.querySelectorAll('.verse')].find(v=> v.dataset.verse == r.ayah.numberInSurah);
        if(t) t.scrollIntoView({behavior:'smooth', block:'center'});
      },400);}
      versesWrap.appendChild(el);
    }
  });
}

/* ---------- scroll to last read (final version: no pause) ---------- */
scrollToLastBtn.addEventListener('click', () => {
  const last = JSON.parse(localStorage.getItem('q_last_v3') || 'null');
  if (!last || !last.surah) {
    alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ø±Ø§Ø¡Ø© Ø³Ø§Ø¨Ù‚Ø© Ù…Ø­ÙÙˆØ¸Ø©');
    return;
  }

  // ğŸ”¹ Ø§Ø­ÙØ¸ Ø§Ù„Ù‚Ø§Ø±Ø¦ Ø§Ù„Ø­Ø§Ù„ÙŠ
  const currentReciter = reciterSelect.value;

  // ğŸ”¹ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³ÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
  if (currentSurah && currentSurah.number === last.surah) {
    // ğŸ”¹ ÙÙ‚Ø· Ù…Ø±Ù‘Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø¢ÙŠØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø© ÙÙŠ Ù†ÙØ³ Ø§Ù„Ø³ÙˆØ±Ø© Ø¯ÙˆÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
    const el = [...document.querySelectorAll('.verse')].find(v => v.dataset.verse == last.verse);
    if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
    return;
  }

  // ğŸ”¹ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø³ÙˆØ±Ø© Ø£Ø®Ø±Ù‰ØŒ Ø­Ù…Ù‘Ù„Ù‡Ø§ Ù„ÙƒÙ† Ø¨Ø¯ÙˆÙ† Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª
  fetch(`https://api.alquran.cloud/v1/surah/${last.surah}`)
    .then(res => res.json())
    .then(data => {
      const s = data.data;
      currentSurah = s;

      surahTitle.textContent = `${s.number} â€” ${s.name}`;
      surahMeta.textContent = `${s.englishName} â€¢ ${s.numberOfAyahs} Ø¢ÙŠØ©`;

      renderVerses({
        number: s.number,
        name: s.name,
        englishName: s.englishName,
        ayahs: s.ayahs
      });

      // ğŸ”¹ Ø£Ø¹ÙØ¯ Ø§Ù„Ù‚Ø§Ø±Ø¦ Ø§Ù„Ù…Ø®ØªØ§Ø± ÙƒÙ…Ø§ Ù‡Ùˆ
      reciterSelect.value = currentReciter;

      // ğŸ”¹ Ù„Ø§ ØªÙˆÙ‚Ù Ø§Ù„ØªÙ„Ø§ÙˆØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      // (Ù„Ø§ ÙŠÙˆØ¬Ø¯ pause Ø£Ùˆ ØªØ´ØºÙŠÙ„ Ø¬Ø¯ÙŠØ¯ Ù‡Ù†Ø§)

      // ğŸ”¹ Ù…Ø±Ù‘Ø± Ø¥Ù„Ù‰ Ø¢Ø®Ø± Ø¢ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
      setTimeout(() => {
        const el = [...document.querySelectorAll('.verse')].find(v => v.dataset.verse == last.verse);
        if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }, 600);
    })
    .catch(err => {
      console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø©:', err);
      alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± Ù‚Ø±Ø§Ø¡Ø©');
    });
});

/* ---------- init ---------- */
function init(){
  populateReciters();
  populateTranslationsAndTafsirs();
  loadQuran();
  renderFavorites();
  // reciter selection change should update player if surah loaded
  reciterSelect.addEventListener('change', ()=> {
    if(currentSurah) initAudioForSurah(currentSurah);
  });
  // set reciterSelect default to first reciter
  reciterSelect.value = Object.keys(RECITERS)[0];
  // allow pressing Enter in topSearch to search immediately
  topSearch.addEventListener('keydown', (e)=> { if(e.key==='Enter'){ performGlobalSearch(topSearch.value); } });
}
init();
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø­Ù‚ÙˆÙ„
  const topSearchEl = document.getElementById('topSearch');
  const mobileSearchEl = document.getElementById('mobileSearch') || document.querySelector('.mobile-search input');

  // Ù…ÙÙŠØ¯ Ù„Ù„Ù€ debug
  function log(...args){ if(window.console) console.log('[search-wire]', ...args); }

  // Ø¯Ø§Ù„Ø© ØªÙ†ØªØ¸Ø± ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ù„Ø© Ø§Ø³Ù…Ù‡Ø§ name Ø«Ù… ØªØ³ØªØ¯Ø¹ÙŠ callback Ø¹Ù†Ø¯Ù…Ø§ ØªØ¸Ù‡Ø± (timeout Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ)
  function waitForFunction(name, callback, timeout = 5000) {
    const start = Date.now();
    (function poll(){
      if (typeof window[name] === 'function') return callback(window[name]);
      if (Date.now() - start > timeout) return callback(null);
      setTimeout(poll, 150);
    })();
  }

  // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø±Ø¨Ø·: Ù†ÙÙØ¶Ù‘Ù„ performGlobalSearch Ø«Ù… renderChapters ÙƒØ¨Ø¯Ø§Ø¦Ù„
  waitForFunction('performGlobalSearch', (fn) => {
    const searchFn = fn || (typeof window.renderChapters === 'function' ? (q => window.renderChapters(q)) : null);

    if (!searchFn) {
      log('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¯Ø§Ù„Ø© performGlobalSearch Ø£Ùˆ renderChapters â€” ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù…Ø­Ù…Ù‘Ù„ Ù‚Ø¨Ù„ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯.');
      return;
    }

    // handler Ù…ÙˆØ­Ù‘Ø¯
    const onInput = (e) => {
      const q = (e.target.value || '').trim();
      if (!q) {
        // Ù„Ùˆ ØªØ±ÙŠØ¯ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¹Ù†Ø¯ Ø¥ÙØ±Ø§Øº Ø§Ù„Ø­Ù‚Ù„:
        // if (typeof window.renderChapters === 'function') window.renderChapters();
        return;
      }
      try { searchFn(q); } catch(err){ log('searchFn error', err); }
    };

    const onEnter = (e) => {
      if (e.key === 'Enter') {
        const q = (e.target.value || '').trim();
        try { searchFn(q); } catch(err){ log('searchFn error', err); }
      }
    };

    // Ø§Ø±Ø¨Ø· Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¥Ù† ÙˆØ¬Ø¯Øª
    if (topSearchEl) {
      topSearchEl.removeEventListener('input', onInput); // ØªØ£Ù…ÙŠÙ† (Ù„Ø§ ÙŠØ¶Ø±)
      topSearchEl.addEventListener('input', onInput);
      topSearchEl.addEventListener('keydown', onEnter);
      log('Ø±Ø¨Ø· topSearch Ø¨Ù†Ø¬Ø§Ø­');
    } else log('Ø¹Ù†ØµØ± #topSearch ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„ØµÙØ­Ø©');

    if (mobileSearchEl) {
      mobileSearchEl.removeEventListener('input', onInput);
      mobileSearchEl.addEventListener('input', onInput);
      mobileSearchEl.addEventListener('keydown', onEnter);
      log('Ø±Ø¨Ø· mobileSearch Ø¨Ù†Ø¬Ø§Ø­');
    } else log('Ø¹Ù†ØµØ± #mobileSearch ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„ØµÙØ­Ø©');

  }, 5000);
});
</script>
<!-- ğŸ”¼ Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù„Ù‰ -->
<button id="scrollTopBtn" title="Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù„Ù‰">
  <span>â†‘</span>
</button>
<script>
window.addEventListener('scroll', () => {
  const btn = document.getElementById('scrollTopBtn');
  if (window.scrollY > 300) {
    btn.classList.add('show');
  } else {
    btn.classList.remove('show');
  }
});

document.getElementById('scrollTopBtn').addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});
</script>
</body>
</html>
